
#include "Noise2D.smd"

in float fogVisibility;

float fogCalculated;

void initFog(vec2 wPos, vec3 skyColor){
	float n=(1+snoise(wPos/200))/2;
	n*=n;
	fogCalculated=fogVisibility-n/5;
	if(fogCalculated<1/255.0){
		fogCalculated=0;
		discard;
	}
}

vec4 applyFog(vec4 initalColor){
	return vec4(mix(skyColor,initalColor.rgb, fogCalculated),initalColor.a);
}